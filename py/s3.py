
import json
import boto3


def _connect_to_bucket():
    with open("local/s3.json") as jsonFile:
        keys = json.load(jsonFile)
    session = boto3.Session(
        aws_access_key_id=keys['aws_access_key_id'],
        aws_secret_access_key=keys['aws_secret_access_key'],
        region_name=keys['s3_region_name'],
    )
    s3 = session.resource('s3')
    return s3.Bucket(keys['s3_bucket_name'])


def upload_file(file_path):
    file_name = file_path.split('/')[-1]
    print ("uploading %s to %s" % (file_path, file_name))
    with open(file_path, 'rb') as data:
        _connect_to_bucket().put_object(Key=file_name, Body=data)
